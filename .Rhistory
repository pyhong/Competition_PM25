plot(tt,r(tt))
r(10)
r(-10)
r(-700)
tt<-seq(-1,1,by=0.01)
plot(tt,r(tt))
tt<-seq(-10,10,by=0.1)
zz<-tt
for(i in 1:length(tt))
zz[i] = r(tt[i])
plot(tt,zz)
tt<-seq(0,700,by=0.1)
zz[i] = r(tt[i])
for(i in 1:length(tt))
zz[i] = r(tt[i])
plot(tt,zz)
dnorm
g<-expression({
f<-function(x)
pnorm(q-x, 250+2880/1600*(x - 150), sqrt(6400-2880/1600*2880))*dnorm(x, 150, 40)
})
r<-function(q)
{
eval(g)
integrate(f, lower = -Inf, upper = q)$value-7/12
}
uniroot(r, c(-1500,1500))
g<-expression({
f<-function(x)
pnorm(q-x, 250+2880/1600*(x - 150), sqrt(6400-2880/1600*2880))*dnorm(x, 150, 40)
})
r<-function(q)
{
eval(g)
integrate(f, lower = -Inf, upper = q)$value-7/12
}
g<-expression({
f<-function(x)
pnorm(q-x, 250+2880/1600*(x - 150), sqrt(6400-2880/1600*2880))*dnorm(x, 150, 40)
})
r<-function(q)
{
eval(g)
integrate(f, lower = -Inf, upper = q)$value-7/12
}
uniroot(r, c(0,700))
tt<-seq(0,700,0.1)
zz<-tt
tt<-seq(0,700,0.1)
zz<-tt
for(i in 1:length(tt))
zz[i] = r(tt[i])
plot(tt,zz)
pi <- seq(0,700,by = 0.1)
ti <- pi
count <- 1
for(q in ti)
{
x<-rnorm(100, 150, 40)
p<-sapply(x, function(m) pnorm(q-m, 250+2880/1600*(m - 150), sqrt(6400-2880/1600*2880)))
pi[count]<-(mean(p)-7/12)
count <- count+1
}
plot(ti, pi, type = "l")
pi <- seq(0,700,by = 0.1)
ti <- pi
count <- 1
for(q in ti)
{
x<-rnorm(1000, 150, 40)
p<-sapply(x, function(m) pnorm(q-m, 250+2880/1600*(m - 150), sqrt(6400-2880/1600*2880)))
pi[count]<-(mean(p)-7/12)
count <- count+1
}
plot(ti, pi, type = "l")
pi <- seq(350,4500,by = 0.1)
ti <- pi
count <- 1
for(q in ti)
{
x<-rnorm(1000, 150, 40)
p<-sapply(x, function(m) pnorm(q-m, 250+2880/1600*(m - 150), sqrt(6400-2880/1600*2880)))
pi[count]<-(mean(p)-7/12)
count <- count+1
}
pi <- seq(350,450,by = 0.1)
ti <- pi
count <- 1
for(q in ti)
{
x<-rnorm(1000, 150, 40)
p<-sapply(x, function(m) pnorm(q-m, 250+2880/1600*(m - 150), sqrt(6400-2880/1600*2880)))
pi[count]<-(mean(p)-7/12)
count <- count+1
}
plot(ti, pi, type = "l")
lm.sol<-lm(pi~ti)
abline(lm.sol, col="red")
cat(paste("root found: ",-lm.sol$coefficients[1]/lm.sol$coefficients[2]))
pi <- seq(400,500,by = 0.1)
ti <- pi
count <- 1
for(q in ti)
{
x<-rnorm(1000, 150, 40)
p<-sapply(x, function(m) pnorm(q-m, 250+2880/1600*(m - 150), sqrt(6400-2880/1600*2880)))
pi[count]<-(mean(p)-7/12)
count <- count+1
}
plot(ti, pi, type = "l")
lm.sol<-lm(pi~ti)
abline(lm.sol, col="red")
cat(paste("root found: ",-lm.sol$coefficients[1]/lm.sol$coefficients[2]))
pi <- seq(400,450,by = 0.1)
ti <- pi
count <- 1
for(q in ti)
{
x<-rnorm(1000, 150, 40)
p<-sapply(x, function(m) pnorm(q-m, 250+2880/1600*(m - 150), sqrt(6400-2880/1600*2880)))
pi[count]<-(mean(p)-7/12)
count <- count+1
}
plot(ti, pi, type = "l")
lm.sol<-lm(pi~ti)
abline(lm.sol, col="red")
cat(paste("root found: ",-lm.sol$coefficients[1]/lm.sol$coefficients[2]))
pi <- seq(400,450,by = 0.1)
ti <- pi
count <- 1
for(q in ti)
{
x<-rnorm(10000, 150, 40)
p<-sapply(x, function(m) pnorm(q-m, 250+2880/1600*(m - 150), sqrt(6400-2880/1600*2880)))
pi[count]<-(mean(p)-7/12)
count <- count+1
}
plot(ti, pi, type = "l")
lm.sol<-lm(pi~ti)
abline(lm.sol, col="red")
cat(paste("root found: ",-lm.sol$coefficients[1]/lm.sol$coefficients[2]))
g<-expression({
f<-function(x)
pnorm(q-x, 250+2880/1600*(x - 150), sqrt(6400-2880/1600*2880))*dnorm(x, 150, 40)
})
r<-function(q)
{
eval(g)
integrate(f, lower = -Inf, upper = q)$value-7/12
}
uniroot(r, c(400,450))
tt<-seq(400,450,0.1)
zz<-tt
for(i in 1:length(tt))
zz[i] = r(tt[i])
plot(tt,zz)
pi <- seq(400,450,by = 1)
ti <- pi
count <- 1
for(q in ti)
{
x<-rnorm(10000, 150, 40)
p<-sapply(x, function(m) pnorm(q-m, 250+2880/1600*(m - 150), sqrt(6400-2880/1600*2880)))
pi[count]<-(mean(p)-7/12)
count <- count+1
}
plot(ti, pi, type = "l")
lm.sol<-lm(pi~ti)
abline(lm.sol, col="red")
cat(paste("root found: ",-lm.sol$coefficients[1]/lm.sol$coefficients[2]))
pi <- seq(400,450,by = 0.1)
ti <- pi
count <- 1
for(q in ti)
{
x<-rnorm(10000, 150, 40)
p<-sapply(x, function(m) pnorm(q-m, 250+2880/1600*(m - 150), sqrt(6400-2880/1600*2880)))
pi[count]<-(mean(p)-7/12)
count <- count+1
}
plot(ti, pi, type = "l")
lm.sol<-lm(pi~ti)
abline(lm.sol, col="red")
cat(paste("root found: ",-lm.sol$coefficients[1]/lm.sol$coefficients[2]))
pi <- seq(400,450,by = 0.1)
ti <- pi
count <- 1
for(q in ti)
{
x<-rnorm(10000, 150, 40)
p<-sapply(x, function(m) pnorm(q-m, 250+2880/1600*(m - 150), sqrt(6400-2880/1600*2880)))
pi[count]<-(mean(p)-7/12)
count <- count+1
}
plot(ti, pi, type = "l")
lm.sol<-lm(pi~ti)
abline(lm.sol, col="red")
cat(paste("root found: ",-lm.sol$coefficients[1]/lm.sol$coefficients[2]))
Rcpp::sourceCpp('D:/KliveKP/math/Bayesian/Bayesian-Data-Analysis-in-R/ACE/ace_g++.cpp')
Rcpp::sourceCpp('D:/KliveKP/math/Bayesian/Bayesian-Data-Analysis-in-R/ACE/ACE_transform_cpponly.cpp')
install.packages("RcppGSL")
install.packages("RcppGSL")
install.packages("RcppGSL")
install.packages("Rcpp")
Rcpp::sourceCpp('D:/KliveKP/math/Bayesian/Bayesian-Data-Analysis-in-R/ACE/ACE_transform_cpponly.cpp')
Rcpp::sourceCpp('D:/KliveKP/math/Bayesian/Bayesian-Data-Analysis-in-R/ACE/ACE_transform_cpponly.cpp')
Rcpp::sourceCpp('D:/test.cpp')
Rcpp::sourceCpp('D:/test.cpp')
Rcpp::sourceCpp('D:/test.cpp')
Rcpp::sourceCpp('D:/test.cpp')
Rcpp::sourceCpp('D:/test.cpp')
Rcpp::sourceCpp('D:/test.cpp')
tt<-test(100, 0, -0.2, 0.4)
tt<-test(100, 0, 1, -0.2, 0.4)
tt
hist(tt)
tt<-test(100, 0, 1, -2, 4)
tt
hist(tt)
plot(density(tt))
tt<-test(1000, 0, 1, -2, 4)
hist(tt)
plot(density(tt))
library(truncnorm)
bb<-rtruncnorm(1000, -2, 4, 0, 1)
hist(bb)
plot(density(bb))
ks.test(tt,bb)
bb<-rtruncnorm(1000, -0.2, 0.4, 0, 1)
tt<-test(1000, 0, 1, -0.2, 0.4)
ks.test(tt,bb)
ks.test(tt,bb)
ks.test(tt,bb)
ks.test(tt,bb)
ks.test(tt,bb)
ks.test(tt,bb)
hist(tt)
plot(density(tt))
hist(bb)
plot(density(bb))
bb<-rtruncnorm(1000, -1.2, 0.4, 0, 1)
tt<-test(1000, 0, 1, -1.2, 0.4)
ks.test(tt,bb)
hist(bb)
hist(tt)
tt<-test(1000, 0, 1, -1.2, 0.4)
bb<-rtruncnorm(1000, -1.2, 0.4, 0, 1)
ks.test(tt,bb)
hist(tt)
hist(bb)
hist(tt)
bb<-rtruncnorm(1000, -1.2, 0.4, 0.5, 2)
tt<-test(1000, 0.5, 2, -1.2, 0.4)
ks.test(tt,bb)
plot(density(bb))
plot(density(tt))
runif(10)
cat(runif(10))
Rcpp::sourceCpp('D:/test.cpp')
Rcpp::sourceCpp('D:/test.cpp')
Rcpp::sourceCpp('D:/test.cpp')
Rcpp::sourceCpp('D:/test.cpp')
tt<-test(1000)
tt
summary(tt)
hist(tt)
table(tt)
aa<-c(0.02718511 ,0.4587501 ,0.7330322, 0.2855598, 0.217619 ,0.3177815, 0.6242823, 0.4957301, 0.2802428, 0.7999797)
bb<-table(tt)
bb
str(bb)
bb[1]
bb[1,1]
bb[1][1]
bb/length(tt)
aa/sum(aa)
tt<-test(100000)
bb<-table(tt)
bb/length(tt)
tt<-test(1000000)
bb/length(tt)
aa/sum(aa)
bb<-table(tt)
bb/length(tt)
load("D:/KliveKP/github/Competition_PM25/com.RData")
tttt<-1
save.image("D:/KliveKP/github/Competition_PM25/com.RData")
tmpvec<-scan("广州历史天气查询.txt",what="",sep=",");
setwd("D:\K\liveKP\\github\\Competition_PM25")
setwd("D:\\KliveKP\\github\\Competition_PM25")
tmpvec<-scan("广州历史天气查询.txt",what="",sep=",");
t=data.frame(matrix(tmpvec[-length(tmpvec)],ncol=4,byrow=T),"城市"="广州",stringsAsFactors=F)
tmpvec<-scan("广州历史天气查询.txt",what="",sep=",");
t=data.frame(matrix(tmpvec[-length(tmpvec)],ncol=4,byrow=T),"城市"="广州",stringsAsFactors=F)
colnames(t)<-c("日期","天气","温度","风向","城市")
tmpvec2<-scan("广州.txt",what="",sep=",");
t2=data.frame(matrix(tmpvec2[-length(tmpvec2)],ncol=7,byrow=T),"城市"="广州",stringsAsFactors=F)
colnames(t2)=c("日期","AQI指数","PM2.5","PM10","Co","No2","So2","城市")
for(i in 2:7)
{
t2[,i]<-as.numeric(t2[,i])
}
dt1<-read.table("广州气象数据.txt",sep=",",head=T)
dt1[,1]<-as.character(as.Date(dt1$CST),format="%Y-%m-%d")
colnames(dt1)<-c("日期",colnames(dt1)[-1])
dt_merge<-merge(dt1,t2,by="日期",stringsAsFactors=F)
dt_merge<-data.frame(dt_merge[,-c(19,21,22,30)])
x<-as.matrix(dt_merge[,c(2:ncol(dt_merge))])
y<-as.matrix(dt_merge$PM2.5[-1])
index<-complete.cases(x)
x<-x[index,]
y<-y[index]
sizex<-nrow(x)
##index<-sample(1:sizex,sizex*1/2)
index<-c(1:(3/4*sizex))
trainx<-x[index,]
trainy<-y[index]
testx<-x[-index,]
testy<-y[-index]
testx<-testx[-nrow(testx),]
testy<-testy[-length(testy)]
##svm
tag_t<-function(y)
{
std_value<-c(51,101,151,201,301)
##std_value<-c(75,150)
for(i in 1:length(std_value))
if(y < std_value[i]) return(i)
return(i+1)
}
kmc_test<-sapply(testy, tag_t)
kmc_train<-sapply(trainy, tag_t)
library(e1071)
kmcy<-cbind(kmc_train, trainx)
svmc<-svm(kmc_train~.,data=kmcy, cost = 10,type="C-classification")
table(predict(svmc), kmc_train)
pred<-predict(svmc, testx)
table(pred,kmc_test)
pri.x<-princomp(trainx)
pre.x<-predict(pri.x,newdata=trainx)
kmc_c<-cbind(kmc_train, pre.x)
svm_c<-svm(kmc_train~.,data=kmc_c,type="C-classification",cost=22)
table(predict(svm_c),kmc_train)
test.x<-predict(pri.x,newdata=testx)
dim(test.x)
table(predict(svm_c,test.x),kmc_test)
rng<-seq(0.1,100,0.1)
error_rate<-rng
for(i in 1:length(rng))
{
svm.fit<-svm(kmc_train~.,data=kmc_c,type="C-classification",cost=rng[i])
error_rate<-sum(predict(svm.fit, test.x)!=kmc_test)
}
error_rate
error_rate<-rng
for(i in 1:length(rng))
{
svm.fit<-svm(kmc_train~.,data=kmc_c,type="C-classification",cost=rng[i])
error_rate[i]<-sum(predict(svm.fit, test.x)!=kmc_test)
}
error_rate<-rng
error_rate<-rng
for(i in 1:length(rng))
{
svm.fit<-svm(kmc_train~.,data=kmc_c,type="C-classification",cost=rng[i])
error_rate[i]<-sum(predict(svm.fit, test.x)!=kmc_test)
}
error_rate
min(error_rate)
which.min(error_rate)
rng[5]
svm_c<-svm(kmc_train~.,data=kmc_c,type="C-classification",cost=0.5)
table(predict(svm_c),kmc_train)
test.x<-predict(pri.x,newdata=testx)
dim(test.x)
table(predict(svm_c,test.x),kmc_test)
error_rate<-error_rate/length(kmc_test)
error_rate
error_rate<-sum(predict(svm.fit, test.x)!=kmc_test)/length(kmc_test)
print(error_rate)
svm_c<-svm(kmc_train~.,data=kmc_c,type="C-classification",cost=0.5)
table(predict(svm_c),kmc_train)
test.x<-predict(pri.x,newdata=testx)
dim(test.x)
table(predict(svm_c,test.x),kmc_test)
error_rate<-sum(predict(svm.fit, test.x)!=kmc_test)/length(kmc_test)
print(error_rate)
rng[5]
svm_c<-svm(kmc_train~.,data=kmc_c,type="C-classification",cost=0.5)
table(predict(svm_c),kmc_train)
test.x<-predict(pri.x,newdata=testx)
dim(test.x)
table(predict(svm_c,test.x),kmc_test)
error_rate<-sum(predict(svm_c, test.x)!=kmc_test)/length(kmc_test)
print(error_rate)
table(predict(svm_c,test.x),kmc_test)
rng<-seq(0.1,100,0.1)
error_rate<-rng
for(i in 1:length(rng))
{
svm.fit<-svm(kmc_train~.,data=kmcy,type="C-classification",cost=rng[i])
error_rate[i]<-sum(predict(svm.fit, testx)!=kmc_test)
}
error_rate
which.min(error_rate)
rng[31]
library(e1071)
kmcy<-cbind(kmc_train, trainx)
svmc<-svm(kmc_train~.,data=kmcy, cost = 3.1,type="C-classification")
table(predict(svmc), kmc_train)
pred<-predict(svmc, testx)
table(pred,kmc_test)
error_rate<-sum(predict(svmc, testx)!=kmc_test)/length(kmc_test)
print(error_rate)
tmpvec<-scan("广州历史天气查询.txt",what="",sep=",");
t=data.frame(matrix(tmpvec[-length(tmpvec)],ncol=4,byrow=T),"城市"="广州",stringsAsFactors=F)
colnames(t)<-c("日期","天气","温度","风向","城市")
tmpvec2<-scan("广州.txt",what="",sep=",");
t2=data.frame(matrix(tmpvec2[-length(tmpvec2)],ncol=7,byrow=T),"城市"="广州",stringsAsFactors=F)
colnames(t2)=c("日期","AQI指数","PM2.5","PM10","Co","No2","So2","城市")
for(i in 2:7)
{
t2[,i]<-as.numeric(t2[,i])
}
dt1<-read.table("广州气象数据.txt",sep=",",head=T)
dt1[,1]<-as.character(as.Date(dt1$CST),format="%Y-%m-%d")
colnames(dt1)<-c("日期",colnames(dt1)[-1])
dt_merge<-merge(dt1,t2,by="日期",stringsAsFactors=F)
dt_merge<-data.frame(dt_merge[,-c(19,21,22,30)])
x<-as.matrix(dt_merge[,c(2:ncol(dt_merge))])
y<-as.matrix(dt_merge$PM2.5[-1])
index<-complete.cases(x)
x<-x[index,]
y<-y[index]
sizex<-nrow(x)
##index<-sample(1:sizex,sizex*1/2)
index<-c(1:(3/4*sizex))
trainx<-x[index,]
trainy<-y[index]
testx<-x[-index,]
testy<-y[-index]
testx<-testx[-nrow(testx),]
testy<-testy[-length(testy)]
##svm
tag_t<-function(y)
{
std_value<-c(51,101,151,201,301)
##std_value<-c(75,150)
for(i in 1:length(std_value))
if(y < std_value[i]) return(i)
return(i+1)
}
kmc_test<-sapply(testy, tag_t)
kmc_train<-sapply(trainy, tag_t)
library(e1071)
kmcy<-cbind(kmc_train, trainx)
svmc<-svm(kmc_train~.,data=kmcy, cost = 3.1,type="C-classification")
table(predict(svmc), kmc_train)
pred<-predict(svmc, testx)
table(pred,kmc_test)
error_rate<-sum(predict(svmc, testx)!=kmc_test)/length(kmc_test)
print(error_rate)
pri.x<-princomp(trainx)
pre.x<-predict(pri.x,newdata=trainx)
kmc_c<-cbind(kmc_train, pre.x)
svm_c<-svm(kmc_train~.,data=kmc_c,type="C-classification",cost=0.5)
table(predict(svm_c),kmc_train)
test.x<-predict(pri.x,newdata=testx)
dim(test.x)
table(predict(svm_c,test.x),kmc_test)
error_rate<-sum(predict(svm_c, test.x)!=kmc_test)/length(kmc_test)
print(error_rate)
rng<-seq(0.1,100,0.1)
error_rate<-rng
for(i in 1:length(rng))
{
svm.fit<-svm(kmc_train~.,data=kmcy,type="C-classification",cost=rng[i])
error_rate[i]<-sum(predict(svm.fit, testx)!=kmc_test)
}
pri.x<-princomp(trainx)
pre.x<-predict(pri.x,newdata=trainx)[,1:4]
kmc_c<-cbind(kmc_train, pre.x)
svm_c<-svm(kmc_train~.,data=kmc_c,type="C-classification",cost=0.5)
table(predict(svm_c),kmc_train)
test.x<-predict(pri.x,newdata=testx)
dim(test.x)
table(predict(svm_c,test.x),kmc_test)
error_rate<-sum(predict(svm_c, test.x)!=kmc_test)/length(kmc_test)
print(error_rate)
rng<-seq(0.1,100,0.1)
error_rate<-rng
for(i in 1:length(rng))
{
svm.fit<-svm(kmc_train~.,data=kmc_c,type="C-classification",cost=rng[i])
error_rate[i]<-sum(predict(svm.fit, test.x)!=kmc_test)
}
min(error_rate)
which.min(error_rate)
plot(error_rate)
plot(1:length(rng), error_rate)
plot(1:length(rng), error_rate/length(kmc_test))
error_rate
pri.x<-princomp(trainx)
pre.x<-predict(pri.x,newdata=trainx)[,1:4]
kmc_c<-cbind(kmc_train, pre.x)
svm_c<-svm(kmc_train~.,data=kmc_c,type="C-classification",cost=0.1)
table(predict(svm_c),kmc_train)
test.x<-predict(pri.x,newdata=testx)
dim(test.x)
table(predict(svm_c,test.x),kmc_test)
error_rate<-sum(predict(svm_c, test.x)!=kmc_test)/length(kmc_test)
print(error_rate)
